# DenyWSUSUpdates
  Скрипт ищет на WSUS сервере обновления Windows 7 выпущенные после января 2021г, ARM64, Itanium, IA64, Embedded
  Скрипт должен быть запущен на WSUS сервере с правами администратора.
  Если запущен без параметров, то просто выведет список таких обновлений.
  Если с параметром -force, то обновления еще и отклоняются.
  Я пока не совсем понимаю когда отклоненные обновления реально удаляются из системы. Возможно для этого надо на WSUS запустить мастер очистки сервера. А может и нет.
  Скрипт работает на моем сервере около 3 часов при 9000 обновлений.

  Название обновлений сравнивается с списками обновлений внутри скрипта и на основе этого выносится решение о отклонении данного обновления
  В скрипте есть белый и черный список обновлений которые содержат шаблоны. Например *ARM64* соответствует всем обновлениям у которых в названии присутствует строка ARM64 а "*Windows 7*02 2021*" соответствует обновлениям Windows 7 выпущенным в феврале 2021г
  Сначала обновления сравниваются с массивом $AlloweUpdatesPatterns и если оно соответствует этому массиву, то оно в любом случает НЕ отклоняется. В данные момент в этот массив занесены "Net Framework" и "Powershell" для Windows 7. Это чтобы обновления на Framework и Powershell приходили даже на старые системы.
  Далее проверяется массив $DenyUpdatesPatterns и если название обновления соответствует этому массиву, то обновление можно отклонять.
  Еще раз повторю, что реально обновления отклоняются только если скрипт запущен с параметром -Force, иначе просто выводится список обновлений кандидатов на отклонение.

  Почему я отклоняю обновления Windows 7 выпущенные после января 2021г?
  Потому что в январе 2021г было выпущено последнее обновление Windows 7. После этого срока обновления Windows 7 будут выпускаться еще 3 года, но уже за деньги. Организация где я работаю этой услуги не купила, поэтому у нас эти обновления раздавались на клиентские компы, устанавливались и при первом же включении долго откатывались на предыдущее состояние. И так происходило каждое утро.
